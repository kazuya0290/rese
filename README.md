## アプリケーション名
<strong>Rese飲食店予約サービスアプリ</strong><br>

Rese飲食店予約サービスアプリは、利用者(ユーザー)が飲食店をエリアやジャンル選択、キーワード検索で簡単に検索し、オンラインで予約できるサービスです。<br> 検索機能は、プルダウンボックスからエリアやジャンルを選択して絞り込むフィルター機能と、キーワード検索機能の2つを提供し、ユーザーが希望の飲食店を迅速に見つけることができます。<br> その他にも、お気に入り店舗の追加、予約管理、QRコード発行、オンライン決済（Stripe決済）、リマインダーメール機能、レビュー投稿など、多彩な機能を提供し、ユーザーの利便性を高めています。<br> また、管理者は店舗代表者の追加・利用者(ユーザー)への一斉メール送信、店舗代表者は店舗情報の更新や新規追加が可能で、店舗運営をサポートします。<br>

<strong>ホーム画面</strong>
![ホーム画面](https://github.com/user-attachments/assets/9ebada05-9bc0-4c5c-892f-a5a2a54f5eaa)

<strong>メニュー画面1</strong>
![メニュー画面1](https://github.com/user-attachments/assets/3bdbcdef-d6d6-439e-89ac-015351422ca1)

<strong>会員登録画面</strong>
![会員登録画面](https://github.com/user-attachments/assets/0049ff30-005d-40db-b906-4e1bb07e484f)

<strong>メール認証画面</strong>
![メール認証画面](https://github.com/user-attachments/assets/fd74e672-7802-464c-b525-a8206762a52d)

<strong>ログイン画面</strong>
![ログイン画面](https://github.com/user-attachments/assets/9fccb6f6-d642-4cd1-a10c-589027be5bd0)

<strong>サンクス画面(会員登録)</strong>
![サンクス画面(会員登録)](https://github.com/user-attachments/assets/a4004a69-717b-4111-a899-9efb4f271a62)

<strong>ホーム画面(ログイン時)</strong>
![ホーム画面(ログイン時)](https://github.com/user-attachments/assets/811f0d16-3d39-454e-9eb3-1017a33c363c)

<strong>メニュー画面2(ログイン時)</strong>
![メニュー画面2(ログイン時)](https://github.com/user-attachments/assets/4c94d24f-86fb-4e73-a649-7b65c0b0e1af)

<strong>店舗詳細画面</strong>
![店舗詳細画面](https://github.com/user-attachments/assets/56cd9ecb-2c43-445c-b57a-783ffe84b915)

<strong>Stripe決済画面</strong>
![Stripe決済画面](https://github.com/user-attachments/assets/bd51be15-f2ce-4659-a39a-74fccc5a3538)

<strong>予約サンクス画面</strong>
![予約サンクス画面](https://github.com/user-attachments/assets/d4567b7a-920c-4226-aa3f-4c90d8789d2e)

<strong>マイページ画面</strong>
![マイページ画面](https://github.com/user-attachments/assets/a3f8f527-5f07-4aeb-92a5-887bf094a975)

<strong>予約リマインダーメール</strong>
![予約リマインダーメール](https://github.com/user-attachments/assets/1b6d2286-64a4-4288-8896-568bf36a79d5)

<strong>予約リマインダーメールの内容</strong>
![予約リマインダーメールの内容](https://github.com/user-attachments/assets/b7503f4e-a6e9-4eb9-bf55-7236d8b76206)

<strong>レビュー投稿画面</strong>
![レビュー投稿画面](https://github.com/user-attachments/assets/a08df26c-6aca-4977-8bbc-f23b091734e1)

<strong>レビュー投稿サンクス画面</strong>
![レビューサンクス画面](https://github.com/user-attachments/assets/b9ded2da-fdf3-43dd-bbee-abd4bd03d1b8)

<strong>レビュー内容確認画面</strong>
![レビュー内容確認画面](https://github.com/user-attachments/assets/10c09b05-9d48-4b6c-92db-d3c52a11a62f)

<strong>管理者画面(店舗代表者の追加)</strong>
![管理者画面(店舗代表者の追加)](https://github.com/user-attachments/assets/636cd693-8134-4bae-b4e8-5f36ea0e26c9)

<strong>管理者画面(利用者(ユーザー)へのお知らせメール送信)</strong>
![管理者画面(利用者へのお知らせメール送信)](https://github.com/user-attachments/assets/36adbcbc-8619-4488-b34e-817bd9e8022c)

<strong>店舗代表者ログイン画面</strong>
![店舗代表者ログイン画面](https://github.com/user-attachments/assets/87f871c9-303b-46f2-bae6-aeba1c575059)

<strong>店舗代表者ホーム画面</strong>
![店舗代表者ホーム画面](https://github.com/user-attachments/assets/0a22f786-003f-4ab4-a37d-5842b96ef5f9)

<strong>店舗代表者ホーム画面2</strong>
![店舗代表者ホーム画面2](https://github.com/user-attachments/assets/12ee82cc-89f4-4079-98ee-7a5354c8c436)

<strong>メニュー画面3(店舗代表者ログイン時)</strong>
![メニュー画面3(店舗代表者ログイン時)](https://github.com/user-attachments/assets/c40c5e7d-ec2d-4a49-b5ee-2744cba6cb07)

<strong>店舗情報の更新画面</strong>
![店舗情報の更新画面](https://github.com/user-attachments/assets/f5b9e087-6400-4eca-bad6-4eea129dbd6d)

<strong>店舗情報の作成画面</strong>
![店舗情報の作成画面](https://github.com/user-attachments/assets/3ee95324-2b44-461b-9af2-5cbbd0eb0c40)

<strong>利用者(ユーザー)予約一覧画面</strong>
![利用者(ユーザー)予約一覧画面](https://github.com/user-attachments/assets/e9ee7e02-d78d-44d2-b23b-e717c10de274)


<strong>-基本機能(上部に添付した画面の説明)-</strong>

・<strong>ホーム画面(店舗一覧)</strong>：各店舗を表示する画面です。画面右上のエリア・ジャンル選択、キーワード検索によるフィルター機能は非ログイン時でも利用可能です。各店舗の「詳しくみる」ボタンをクリックすると、店舗詳細情報を閲覧することが出来ます。<br>

・<strong>メニュー画面1</strong>：画面左上のアイコン(ハンバーガーメニュー)をクリックするとメニュー画面が表示され、変化した×をクリックするとメニューを閉じることが出来ます。上から順にHomeをクリックするとホーム画面が表示され、Registrationをクリックすると会員登録画面、Loginをクリックするとログイン画面が表示されます。<br>

・<strong>会員登録画面</strong>：名前、メールアドレス、パスワード(確認用にも同じパスワードを入力する必要あり)を入力し、メール認証を行うことによって会員登録を行うことが可能です。<br>

・<strong>メール認証画面</strong>：この画面が出た後、mailhog(localhost:8025)にメールが届くので、Verify Email Addressをクリックして認証を行うことで会員登録が完了し、ログインすることが出来ます。メールが届かない場合は「再送するにはこちらをクリック」をクリックしてください。<br>

・<strong>ログイン画面</strong>：会員登録を行った後、この画面から登録したメールアドレスとパスワードを入力することで、ログインすることが出来ます。また、管理者・店舗代表者のログインもここから可能です。<br>

・<strong>サンクス画面(会員登録)</strong>：メール認証後、この画面が表示され、「ログインする」ボタンをクリックすることで、ログイン状態となり、ホーム画面が表示されます。<br>

・<strong>ホーム画面(ログイン時)</strong>：ログインすることで、お気に入り追加・削除機能、マイページの閲覧、詳細画面からの予約機能等全ての機能を利用することが可能となります。<br>

・<strong>メニュー画面2(利用者(ユーザー)ログイン時)</strong>：非ログイン時と少し変わり、Homeはクリックすると非ログイン時と同じくホーム画面が表示され、Logoutボタンをクリックするとログアウト確認のアラートメッセージが表示され、OKをクリックするとログアウト状態となり、Mypageをクリックするとマイページ画面が表示されます。<br>

・<strong>店舗詳細画面</strong>：店舗の画像、エリア・ジャンルのハッシュタグ、店舗の詳細な説明が記載されてあります。「<」をクリックすると一覧に戻り、「画像を保存する」ボタンをクリックするとストレージに画像を保存することが可能です(非ログイン時でも画像の保存は可能)。右側の予約フォームは非ログイン時には利用することが出来ませんが、ログイン時には上から順に日付、時間、人数をそれぞれ選択することで予約を行うことが可能です。また、予約方法は通常予約とStripe決済を利用しての予約とを選ぶことが出来ます。<br>

・<strong>Stripe決済画面</strong>：Stripe決済を利用して予約する場合、メールアドレス、クレジットカード番号、有効期限(MM → 月  YY → 年)、3桁以上のCVC(セキュリティコード)を入力して「¥1,000を支払う」ボタンをクリックすることで予約を行うことが可能です。(※テスト用としてクレジットカード番号は「4242 4242 4242 4242」を必ず入力してください 有効期限、セキュリティーコードは何でも構いません)<br>

・<strong>予約サンクス画面</strong>：無事に予約処理が完了するとこの画面が表示されます。「マイページへ戻る」ボタンをクリックすることでマイページに戻ることが出来ます。<br>

・<strong>マイページ画面</strong>：ホーム画面でお気に入り追加した店舗や、店舗詳細画面で予約した内容が一覧表示されます。お気に入り追加・削除はホーム画面およびこの画面の両方で可能です。また、予約情報の変更はこの画面から行えます。「QRコードを発行する」ボタンで店舗向けのQRコードを生成可能です。「予約変更」ボタンは、予約内容の変更がない限り非アクティブになっており、カーソルを合わせるとクリック不可の理由が表示されます。<br>

・<strong>予約リマインダーメール</strong>：予約当日の朝にリマインダーメールをmailhog(localhost:8025)に送信できます。Kernel.php（src > app > Console）で、朝6時にメールが届くよう設定していますが、dailyAt('06:00')部分を変更すれば配信時間を調整可能です。メールは自動送信されないため、ターミナルでdocker-compose exec php bashを実行し、PHPコンテナ内で指定の時間にphp artisan schedule:runを実行して送信してください（例: 朝8時に送信する場合は8:00に設定）。<br>

・<strong>予約リマインダーメールの内容</strong>：予約した店舗名、日時、人数が記載されております。 また、リンクになっている「レビューする」をクリックするとその店舗のレビュー投稿画面が表示されます。<br>

・<strong>レビュー投稿画面</strong>：各店舗の５段階評価、コメントを記入することが可能です。５段階評価はカーソルを星に合わせてクリックすることで評価することが可能となっております。<br>

・<strong>レビュー投稿サンクス画面</strong>：無事にレビューの投稿が完了すると表示されます。「マイページへ戻る」をクリックするとマイページ画面が表示されます。<br>

・<strong>レビュー内容確認画面</strong>：各店舗の詳細画面にレビュー画面にて評価・コメントした情報がこちらで反映されます。「(〇件の口コミ)」をクリックすることで投稿された日付、ユーザー名に加え、記載されたコメントがモーダルウィンドウで表示されます。画面上の×ボタンをクリックすることで閉じることが出来ますが、画面のどの部分をクリックしても画面を閉じることが可能です。<br>

・<strong>管理者画面(店舗代表者の追加)</strong>：※管理者の方は「こちら」をクリックし、表示されたダイアログのテキスト入力欄にパスコード「admin」を入力することで管理者画面を開くことが出来ます。画面上部の店舗代表者の追加では、追加したい店舗代表者の氏名、メールアドレス、パスワードを入力し、「店舗代表者を追加」ボタンをクリックすることで店舗代表者を追加することが可能です。<br>

・<strong>管理者画面(利用者(ユーザー)へのお知らせメール送信)</strong>：画面下部の利用者へのお知らせメール送信では、件名とメッセージ内容を入力することで登録済みの利用者(ユーザー)全員に一斉メールを送信することが可能です。<br>

・<strong>店舗代表者ログイン画面</strong>：利用者(ユーザー)ログイン画面と同様、管理者画面にて追加された代表者の正しいメールアドレスとパスワードを入力することで店舗代表者としてログインすることが可能です。<br>

・<strong>店舗代表者ホーム画面</strong>：画面上部にログインした店舗代表者の氏名とメッセージが表示されます。利用者(ユーザー)ログイン時、非ログイン時と同様、フィルター機能は利用可能ですが、お気に入り追加・削除機能は利用できない仕組みになっております。また、「詳しくみる」ボタンではなく「更新」ボタンに変化し、ここをクリックすることで、店舗情報の更新画面を開くことが出来ます。<br>

・<strong>店舗代表者ホーム画面2</strong>：店舗代表者ホーム画面最下部に店舗を追加というリンクを付けております。ここをクリックすることで、店舗情報の作成画面を開くことが出来ます。<br>

・<strong>メニュー画面3(店舗代表者ログイン時)</strong>：利用者(ユーザー)と同じく、HomeとLogoutの機能は同じですが、Reservation Listをクリックすると利用者(ユーザー)の予約一覧を確認することが出来ます。<br>

・<strong>店舗情報の更新画面</strong>：この画面から新しく作成した店舗を含め、店舗情報の更新(修正)を行うことが可能です。店舗名、エリア、ジャンル、説明、表示したい店舗のイメージ画像のどれかを変更しないと更新ボタンがクリック出来ない仕組みとなっております。<br>

・<strong>店舗情報の作成画面</strong>：更新画面と同じフォームで、全ての項目を入力・設定することで新店舗を追加することがこの画面より可能です。画像を含め、全ての項目の入力・設定が必須となっております。<br>

・<strong>利用者(ユーザー)予約一覧画面</strong>：メニュー画面3のReservation Listをクリックするとこちらの画面が開かれます。この画面より利用者(ユーザー)の氏名、メールアドレスを含めた詳細な予約情報を閲覧することが可能です。ページネーションを使用しており、7件ごとのデータを表示するように設定しております。<br>

## 作成した目的
外部予約サービスの手数料を回避するため、自社で予約システムを持ちたいという依頼を受けて開発しました。<br>ユーザー・管理者・店舗代表者のそれぞれに使いやすい設計となっております。<br>

## アプリケーションURL
http://localhost/ (ホーム画面・飲食店一覧ページ)<br>
http://localhost/login (ログインページ)<br>
http://localhost/verify (メール認証ページ)<br>
http://localhost/representative/login (店舗代表者ログインページ)<br>
http://localhost/register (会員登録ページ)<br>
http://localhost/mypage (マイページ)<br>
http://localhost/shop/{id} (各飲食店詳細ページ)<br>
http://localhost/shop/{id}/edit (各飲食店更新ページ)<br>
http://localhost/shop/create (店舗追加ページ)<br>
http://localhost/admin (管理者ページ)<br>
http://localhost/representative (利用者(ユーザー)予約一覧ページ)<br>
http://localhost/register_thanks (会員登録サンクスページ)<br>
http://localhost/review_thanks (レビュー投稿サンクスページ)<br>

## 他のリポジトリ
git@github.com:kazuya0290/rese.git<br>
→ 飲食店予約サービス、その他設定ファイルを含むリポジトリです。<br>

## 機能一覧
1.メニュー選択機能<br>
2.ログイン機能<br>
3.会員登録機能<br>
4.メール認証機能<br>
5.お気に入り登録・削除機能<br>
6.エリア・ジャンル選択・キーワード検索によるフィルター機能<br>
7.店舗予約機能<br>
8.店舗画像保存機能<br>
9.マイページからの予約内容変更・キャンセル(削除)機能<br>
10.QRコード発行・照合機能<br>
11.Stripe決済機能<br>
12.予約リマインダーメール送信機能<br>
13.レビュー機能<br>
14.コメント閲覧機能<br>
15.管理者による店舗代表者追加機能 (店舗の代表者を新たに登録)<br>
16.管理者による登録済利用者(ユーザー)一斉メール送信機能<br>
17.店舗代表者による利用者(ユーザー)予約内容確認機能<br>
18.店舗代表者による既存店舗更新機能<br>
19.店舗代表者による新規店舗作成機能<br>

## 使用技術(実行環境)
-Laravel Framework 8.83.8<br>
-PHP 7.4.9<br>
-JavaScript<br>
-MySQL (マイグレーションは php artisan migrate を使用)<br>
-Mailhog 1.0.1 (開発環境用のメール送受信ツール)<br>
-qrcodejs 1.0.0 (QRコード発行ライブラリ)<br>
-Stripe PHP 9.9 (決済システム)<br>

## テーブル図
![areas](https://github.com/user-attachments/assets/d9b3ae8f-c605-4e5e-aee9-420a2c9afac9)

![details](https://github.com/user-attachments/assets/2d3247ee-f87a-465e-9334-d451f7d9b5e8)

![favorites](https://github.com/user-attachments/assets/445f0546-098b-4d0b-bbe7-8316dd4eef5d)

![genres](https://github.com/user-attachments/assets/49ad7721-9717-4060-aefd-e1836e3a1aa2)

![representatives](https://github.com/user-attachments/assets/88a68299-2079-4b2a-b59a-987d9dce62ed)

![reservations](https://github.com/user-attachments/assets/c2f89f76-9078-48b5-afb8-c862d56aced4)

![reviews](https://github.com/user-attachments/assets/2aeace73-94d5-4198-8ecc-9a2696f0ae69)

![shops](https://github.com/user-attachments/assets/4e719628-0e3b-45b3-89a9-eece4d58a499)

![shops_users](https://github.com/user-attachments/assets/99997495-5143-4d74-b060-6e2ffb7c96b3)

![users](https://github.com/user-attachments/assets/6e818e97-8fc4-4476-8d7b-3b7d49f23ce0)

## ER図
![er](https://github.com/user-attachments/assets/ba5bbe11-ba8d-4921-bccd-eee107f2ea39)

## 環境構築
-<strong> Dockerのビルド</strong>-<br>

1.リポジトリのクローン<br>
→```git clone git@github.com:kazuya0290/rese.git```<br>
2.Dockerデスクトップを立ち上げ、作成したコンテナを起動する。<br>
3.コンテナの起動と再ビルド<br>
→```docker-compose up -d --build```<br>

-<strong>Laravel環境構築</strong>-<br>

1.Dockerコンテナに入る<br>
→```docker-compose exec php bash```<br>
2.Composerのインストール<br>
→```composer install```<br>
3.「.env.example」ファイルを 「.env」ファイルに命名を変更。または、新しく.envファイルを作成<br>
→```cp .env.example .env```<br>
4..envに以下の環境変数を追加<br>
```
DB_CONNECTION=mysql
DB_HOST=mysql
DB_PORT=3306
DB_DATABASE=laravel_db
DB_USERNAME=laravel_user
DB_PASSWORD=laravel_pass
BROADCAST_DRIVER=log
CACHE_DRIVER=file
FILESYSTEM_DRIVER=local
QUEUE_CONNECTION=sync
SESSION_DRIVER=file
SESSION_LIFETIME=120
MEMCACHED_HOST=127.0.0.1
REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379
MAIL_MAILER=smtp
MAIL_HOST=mailhog
MAIL_PORT=1025
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null
MAIL_FROM_ADDRESS=example@example.com
MAIL_FROM_NAME="Example"
STRIPE_KEY=pk_test_51QCaiKINecNlWRFz1faiSxHyYUW6BKkysgHeSitbGAU0VJjH3HGdYFEcAlZxJNkHUiBAhju7eyklW2AGn2mqS2zd00B4Xp1iSg
STRIPE_SECRET=sk_test_51QCaiKINecNlWRFzZ15SXBwdCEs5c1gX1Yo7W0ArQ4g5jDqY3Qji3TFOyOtLcc9g8fJvfRcnwSGtO4IUhfMswSsx00OTvsCtV9
```
5.アプリケーションキーの作成<br>
→```php artisan key:generate```<br>
6.マイグレーションの実行<br>
→```php artisan migrate```<br>
7.シーディングの実行(データ・ダミーデータの挿入)<br>
→```php artisan db:seed```<br>

-<strong>使用するパッケージについて</strong>-<br>

1.QRコード生成<br>
QRコード発行機能に simplesoftwareio/simple-qrcode ライブラリを使用しています。このパッケージにより、Laravel内で簡単にQRコードを生成できます。<br>
2.Stripe決済機能<br>
決済機能には stripe/stripe-php を使用しています。このライブラリを利用することで、Stripe APIと簡単に連携し、オンライン決済処理を行うことができます。<br>
3.メール送信（MailHog）<br>
開発環境でのメール送信には MailHog を使用しています。MAIL_MAILER=smtp と MAIL_HOST=mailhog の設定により、送信されたメールは http://localhost:8025 の MailHog ダッシュボードで確認できます。MailHogは開発環境でメール送信をテストするためのツールです。<br>

## URL
- 開発環境: http://localhost/ <br>
- mailhog : http://localhost:8025/<br>
- phpMyAdmin : http://localhost:8080/<br>
- 本番環境 : https://rese-he2e.onrender.com (従量課金制の為、サービス停止中)<br>

## その他
mailhog(localhost:8025)にて届いたメールを開くとhtmlメッセージが表示されないことがあります。その場合は1度メールを閉じて再度開くと表示されます。(手順：メールをクリック →　InBoxをクリック → 再度メールをクリック)<br>
Dockerfile,default.conf,docker-compose.ymlファイルは開発環境と本番環境のコードに分けて記載してあります。<br>通常は開発環境のコードを表示しており、本番環境のコードはコメントアウトしております。<br>Render.comは従量課金制の為、無料で利用するためにサービスを停止しております。<br>
