## アプリケーション名
<b>Rese飲食店予約サービスアプリ</b><br>
利用者(ユーザー)が飲食店をエリアやジャンルごとに検索し、予約できるサービスです。<br>お気に入り追加や予約の管理機能、リマインダーメール、レビュー投稿機能など、利用者が便利に使える機能が揃っています。<br>また、管理者や店舗代表者の機能も提供しており、店舗情報の更新や新規追加が可能です。<br>

<b>ホーム画面</b>
![ホーム画面](https://github.com/user-attachments/assets/9ebada05-9bc0-4c5c-892f-a5a2a54f5eaa)

<b>メニュー画面1</b>
![メニュー画面1](https://github.com/user-attachments/assets/3bdbcdef-d6d6-439e-89ac-015351422ca1)

<b>会員登録画面</b>
![会員登録画面](https://github.com/user-attachments/assets/0049ff30-005d-40db-b906-4e1bb07e484f)

<b>メール認証画面</b>
![メール認証画面](https://github.com/user-attachments/assets/fd74e672-7802-464c-b525-a8206762a52d)

<b>ログイン画面</b>
![ログイン画面](https://github.com/user-attachments/assets/9fccb6f6-d642-4cd1-a10c-589027be5bd0)

<b>サンクス画面(会員登録)</b>
![サンクス画面(会員登録)](https://github.com/user-attachments/assets/a4004a69-717b-4111-a899-9efb4f271a62)

<b>ホーム画面(ログイン時)</b>
![ホーム画面(ログイン時)](https://github.com/user-attachments/assets/811f0d16-3d39-454e-9eb3-1017a33c363c)

<b>メニュー画面2(ログイン時)</b>
![メニュー画面2(ログイン時)](https://github.com/user-attachments/assets/4c94d24f-86fb-4e73-a649-7b65c0b0e1af)

<b>店舗詳細画面</b>
![店舗詳細画面](https://github.com/user-attachments/assets/56cd9ecb-2c43-445c-b57a-783ffe84b915)

<b>Stripe決済画面</b>
![Stripe決済画面](https://github.com/user-attachments/assets/bd51be15-f2ce-4659-a39a-74fccc5a3538)

<b>予約サンクス画面</b>
![予約サンクス画面](https://github.com/user-attachments/assets/d4567b7a-920c-4226-aa3f-4c90d8789d2e)

<b>マイページ画面</b>
![マイページ画面](https://github.com/user-attachments/assets/a3f8f527-5f07-4aeb-92a5-887bf094a975)

<b>予約リマインダーメール</b>
![予約リマインダーメール](https://github.com/user-attachments/assets/1b6d2286-64a4-4288-8896-568bf36a79d5)

<b>予約リマインダーメールの内容</b>
![予約リマインダーメールの内容](https://github.com/user-attachments/assets/b7503f4e-a6e9-4eb9-bf55-7236d8b76206)

<b>レビュー投稿画面</b>
![レビュー投稿画面](https://github.com/user-attachments/assets/a08df26c-6aca-4977-8bbc-f23b091734e1)

<b>レビュー投稿サンクス画面</b>
![レビューサンクス画面](https://github.com/user-attachments/assets/b9ded2da-fdf3-43dd-bbee-abd4bd03d1b8)

<b>レビュー内容確認画面</b>
![レビュー内容確認画面](https://github.com/user-attachments/assets/10c09b05-9d48-4b6c-92db-d3c52a11a62f)

<b>管理者画面(店舗代表者の追加)</b>
![管理者画面(店舗代表者の追加)](https://github.com/user-attachments/assets/636cd693-8134-4bae-b4e8-5f36ea0e26c9)

<b>管理者画面(利用者へのお知らせメール送信)</b>
![管理者画面(利用者へのお知らせメール送信)](https://github.com/user-attachments/assets/36adbcbc-8619-4488-b34e-817bd9e8022c)

<b>店舗代表者ログイン画面</b>
![店舗代表者ログイン画面](https://github.com/user-attachments/assets/87f871c9-303b-46f2-bae6-aeba1c575059)

<b>店舗代表者ホーム画面</b>
![店舗代表者ホーム画面](https://github.com/user-attachments/assets/0a22f786-003f-4ab4-a37d-5842b96ef5f9)

<b>店舗代表者ホーム画面2</b>
![店舗代表者ホーム画面2](https://github.com/user-attachments/assets/12ee82cc-89f4-4079-98ee-7a5354c8c436)

<b>メニュー画面3(店舗代表者ログイン時)</b>
![メニュー画面3(店舗代表者ログイン時)](https://github.com/user-attachments/assets/c40c5e7d-ec2d-4a49-b5ee-2744cba6cb07)

<b>店舗情報の更新画面</b>
![店舗情報の更新画面](https://github.com/user-attachments/assets/f5b9e087-6400-4eca-bad6-4eea129dbd6d)

<b>店舗情報の作成画面</b>
![店舗情報の作成画面](https://github.com/user-attachments/assets/3ee95324-2b44-461b-9af2-5cbbd0eb0c40)

<b>利用者(ユーザー)予約一覧画面</b>
![利用者(ユーザー)予約一覧画面](https://github.com/user-attachments/assets/e9ee7e02-d78d-44d2-b23b-e717c10de274)

<b>-基本機能(上部に添付した画面の説明)-</b><br>
・ホーム画面(店舗一覧)：画面右上のエリア・ジャンル選択、キーワード検索によるフィルター機能は非ログイン時でも利用可能です。画面左上のメニューボタン(ハンバーガーメニュー)をクリックするとメニュ画面が表示され、各店舗の「詳しくみる」ボタンをクリックすると、店舗詳細情報を閲覧することが出来ます。<br>

・メニュー画面1:上から順にHomeをクリックするとホーム画面が表示され、Registrationをクリックすると会員登録画面、Loginをクリックするとログイン画面が表示されます。<br>

・会員登録画面：名前、メールアドレス、パスワード(確認用にも同じパスワードを入力する必要あり)を入力し、メール認証を行うことによって会員登録を行うことが可能です。<br>

・メール認証画面 : この画面が出た後、mailhog(localhost:8025)にメールが届くので、Verify Email Addressをクリックして認証を行うことで会員登録が完了し、ログインすることが出来ます。メールが届かない場合は「再送するにはこちらをクリック」をクリックしてください。<br>

・ログイン画面:会員登録を行った後、この画面から登録したメールアドレスとパスワードを入力することで、ログインすることが出来ます。<br>

・サンクス画面(会員登録):メール認証後、この画面が表示され、「ログインする」ボタンをクリックすることで、ログイン状態となり、ホーム画面が表示されます。<br>

・ホーム画面(ログイン時):ログインすることで、お気に入り追加・削除機能、マイページの閲覧、詳細画面からの予約機能等全ての機能を利用することが可能となります。<br>

・メニュー画面2(ログイン時):非ログイン時と少し変わり、Homeはクリックすると非ログイン時と同じくホーム画面が表示され、Logoutボタンをクリックするとログアウト確認のアラートメッセージが表示され、OKをクリックするとログアウト状態となり、Mypageをクリックするとマイページ画面が表示されます。<br>

・店舗詳細画面:店舗の画像、エリア・ジャンルのハッシュタグ、店舗の詳細な説明が記載されてあります。「<」をクリックすると一覧に戻り、「画像を保存する」ボタンをクリックするとストレージに画像を保存することが可能です(非ログイン時でも画像の保存は可能)。右側の予約フォームは非ログイン時には利用することが出来ませんが、ログイン時には上から順に日付、時間、人数をそれぞれ選択することで予約を行うことが可能です。また、予約方法は通常予約とStripe決済を利用しての予約とを選ぶことが出来ます。<br>

・Stripe決済画面:Stripe決済を利用して予約する場合、メールアドレス、クレジットカード番号、有効期限(MM → 月  YY → 年)、3桁以上のCVC(セキュリティコード)を入力して「¥1,000を支払う」ボタンをクリックすることで予約を行うことが可能です。(※テスト用としてクレジットカード番号は「4242 4242 4242 4242」を必ず入力してください 有効期限、セキュリティーコードは何でも構いません)<br>

・予約サンクス画面: 無事に予約処理が完了するとこの画面が表示されます。「マイページへ戻る」ボタンをクリックすることでマイページに戻ることが出来ます。<br>

・マイページ画面:ホーム画面にてお気に入り追加した店舗と店舗詳細画面にて予約した予約の詳細内容がこの画面で表示されます。お気に入り追加・削除はホーム画面でもこの画面でも行うことが出来、予約情報の変更はこちらの画面で行うことが可能です。「予約変更」のボタンは予約情報の変更を行わない限りクリックすることが出来ないしくみとなっております。また、変更を行ったにも関わらずクリック出来ない場合はボタンにカーソルを合わせることでクリック出来ない理由が表示されます。<br>

・予約リマインダーメール:mailhog(localhost:8025)にて予約当日の朝に予約情報のリマインダーメールを送ることが可能です。src > app > Consoleディレクトリに存在するKernel.phpファイルにて予約当日の朝6時(dailyAt('06:00'))にリマインダーメールが届く設定にしておりますが、Kernel.phpのこの時間の箇所を変更することで届ける時間帯を変えることが可能です。自動でメールは届かないので、ターミナルにて「docker-compose exec php bash」コマンドを実行してPHPコンテナに入り、合わせた時間帯(朝8時であれば8:00に変更)に「php artisan schedule:run」を実行することでメールを送ることが可能です。<br>

・予約リマインダーメールの内容:予約した店舗名、日時、人数が記載されております。 また、リンクになっている「レビューする」をクリックするとその店舗のレビュー投稿画面が表示されます。<br>

・レビュー投稿画面:各店舗の５段階評価、コメントを記入することが可能です。５段階評価はカーソルを星に合わせてクリックすることで評価することが可能となっております。<br>

・レビュー投稿サンクス画面:<br>
・レビュー内容確認画面:<br>
・管理者画面(店舗代表者の追加):<br>
・管理者画面(利用者へのお知らせメール送信):<br>
・店舗代表者ログイン画面:<br>
・店舗代表者ホーム画面:<br>
・店舗代表者ホーム画面2:<br>
・メニュー画面3(店舗代表者ログイン時):<br>
・店舗情報の更新画面:<br>
・店舗情報の作成画面:<br>
・利用者(ユーザー)予約一覧画面:

## 作成した目的
外部予約サービスの手数料を回避するため、自社で予約システムを持ちたいという依頼を受けて開発しました。<br>ユーザー・管理者・店舗代表者のそれぞれに使いやすい設計となっております。<br>

## アプリケーションURL
http://localhost/ (ホーム画面・飲食店一覧ページ)<br>
http://localhost/login (ログインページ)<br>
http://localhost/verify (メール認証ページ)<br>
http://localhost/representative/login (店舗代表者ログインページ)<br>
http://localhost/register (会員登録ページ)<br>
http://localhost/mypage (マイページ)<br>
http://localhost/shop/{id} (各飲食店詳細ページ)<br>
http://localhost/shop/{id}/edit (各飲食店更新ページ)<br>
http://localhost/shop/create (店舗追加ページ)<br>
http://localhost/admin (管理者ページ)<br>
http://localhost/representative (利用者(ユーザー)予約一覧ページ)<br>
http://localhost/register_thanks (会員登録サンクスページ)<br>
http://localhost/review_thanks (レビュー投稿サンクスページ)<br>

## 他のリポジトリ
git@github.com:kazuya0290/rese.git<br>
→　飲食店予約サービス、その他設定ファイルを含むリポジトリです。

## 機能一覧
1.メニュー選択機能<br>
2.ログイン機能<br>
3.会員登録機能<br>
4.メール認証機能<br>
5.お気に入り登録・削除機能<br>
6.エリア・ジャンル選択・キーワード検索によるフィルター機能<br>
7.店舗予約機能<br>
8.店舗画像保存機能<br>
9.マイページからの予約内容変更・キャンセル(削除)機能<br>
10.QRコード発行・照合機能
11.Stripe決済機能
12.予約リマインダーメール送信機能<br>
13.レビュー機能<br>
14.コメント閲覧機能<br>
15.管理者による店舗代表者追加機能<br>
16.管理者による登録済利用者(ユーザー)一斉メール送信機能<br>
17.店舗代表者による利用者(ユーザー)予約内容確認機能<br>
18.店舗代表者による既存店舗更新機能<br>
19.店舗代表者による新規店舗作成機能

## 使用技術(実行環境)
-Laravel Framework 8.83.8<br>
-PHP 7.4.9<br>
-JavaScript<br>
-MySQL-> php artisan migrateによるマイグレーション<br>
-Mailhog 1.0.1<br>

## テーブル図

![areas](https://github.com/user-attachments/assets/d9b3ae8f-c605-4e5e-aee9-420a2c9afac9)

![details](https://github.com/user-attachments/assets/2d3247ee-f87a-465e-9334-d451f7d9b5e8)

![favorites](https://github.com/user-attachments/assets/445f0546-098b-4d0b-bbe7-8316dd4eef5d)

![genres](https://github.com/user-attachments/assets/49ad7721-9717-4060-aefd-e1836e3a1aa2)

![representatives](https://github.com/user-attachments/assets/88a68299-2079-4b2a-b59a-987d9dce62ed)

![reservations](https://github.com/user-attachments/assets/c2f89f76-9078-48b5-afb8-c862d56aced4)

![reviews](https://github.com/user-attachments/assets/2aeace73-94d5-4198-8ecc-9a2696f0ae69)

![shops](https://github.com/user-attachments/assets/4e719628-0e3b-45b3-89a9-eece4d58a499)

![shops_users](https://github.com/user-attachments/assets/99997495-5143-4d74-b060-6e2ffb7c96b3)

![users](https://github.com/user-attachments/assets/6e818e97-8fc4-4476-8d7b-3b7d49f23ce0)

## ER図

![er](https://github.com/user-attachments/assets/ba5bbe11-ba8d-4921-bccd-eee107f2ea39)

## 環境構築
<b>- Dockerのビルド -</b><br>
1.リポジトリのクローン　→　git clone git@github.com:kazuya0290/rese.git<br>
2.Dockerデスクトップを立ち上げ、作成したコンテナを起動する。<br>
3.コンテナの起動と再ビルド　→　docker-compose up -d --build

  <b>-Laravel環境構築-</b>
1. Dockerコンテナに入る　→　docker-compose exec php bash
2. Composerのインストール　→　composer install
3. 「.env.example」ファイルを 「.env」ファイルに命名を変更。または、新しく.envファイルを作成
4. .envに以下の環境変数を追加<br>
DB_CONNECTION=mysql<br>
DB_HOST=mysql<br>
DB_PORT=3306<br>
DB_DATABASE=laravel_db<br>
DB_USERNAME=laravel_user<br>
DB_PASSWORD=laravel_pass<br>
BROADCAST_DRIVER=log<br>
CACHE_DRIVER=file<br>
FILESYSTEM_DRIVER=local<br>
QUEUE_CONNECTION=sync<br>
SESSION_DRIVER=file<br>
SESSION_LIFETIME=120<br>
MEMCACHED_HOST=127.0.0.1<br>
REDIS_HOST=127.0.0.1<br>
REDIS_PASSWORD=null<br>
REDIS_PORT=6379<br>
MAIL_MAILER=smtp<br>
MAIL_HOST=mailhog<br>
MAIL_PORT=1025<br>
MAIL_USERNAME=null<br>
MAIL_PASSWORD=null<br>
MAIL_ENCRYPTION=null<br>
MAIL_FROM_ADDRESS=example@example.com<br>
MAIL_FROM_NAME="Example"<br>
STRIPE_KEY=pk_test_51QCaiKINecNlWRFz1faiSxHyYUW6BKkysgHeSitbGAU0VJjH3HGdYFEcAlZxJNkHUiBAhju7eyklW2AGn2mqS2zd00B4Xp1iSg<br>
STRIPE_SECRET=sk_test_51QCaiKINecNlWRFzZ15SXBwdCEs5c1gX1Yo7W0ArQ4g5jDqY3Qji3TFOyOtLcc9g8fJvfRcnwSGtO4IUhfMswSsx00OTvsCtV9<br>
5. アプリケーションキーの作成<br>
→　php artisan key:generate<br>
6. マイグレーションの実行<br>
→　php artisan migrate<br>
7. シーディングの実行<br>
→　php artisan db:seed

## URL
- 開発環境：http://localhost/ <br>
- mailhog : http://localhost:8025/<br>
- phpMyAdmin : http://localhost:8080/<br>
- 本番環境 : https://rese-he2e.onrender.com (従量課金制の為、サービス停止中)

## その他　<b>アプリケーションURL(特に本番環境について)</b>
mailhogにて届いたメールを開くとhtmlメッセージが表示されないことがあります。その場合は１度メールを閉じて再度開くと表示されます。
Dockerfile,default.conf,docker-compose.ymlファイルは開発環境と本番環境のコードに分けて記載してあります。通常は開発環境のコードを表示、本番環境のコードをコメントアウトしております。<br>Render.comは従量課金制の為、無料で利用するためにサービスを停止しております。<br>
